{"version":3,"sources":["builder/animation_builder.ts"],"names":[],"mappings":"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","file":"animation_builder.js","sourcesContent":["import { AnimationOptions, ElementProps, ListenerRef, TimeoutRef, } from '../contracts';\n\nexport enum AnimationMode {\n  Animate,\n  Show,\n  Hide,\n};\n\nexport class AnimationBuilder {\n\n  private static _DEBUG: boolean = false;\n  private static _disabled: boolean = false;\n\n  private static _defaults: AnimationOptions = {\n    disabled: false,\n    fixed: false,\n    reject: true,\n    useVisibility: false,\n    pin: true,\n    type: 'bounce',\n    fillMode: 'none',\n    timingFunction: 'ease',\n    playState: 'running',\n    direction: 'normal',\n    duration: 1000,\n    delay: 0,\n    iterationCount: 1,\n  };\n\n  private static raf: Function = window.requestAnimationFrame\n    ? window.requestAnimationFrame.bind(window)\n    : setTimeout;\n\n  private animationOptions: AnimationOptions;\n  private defaultOptions: AnimationOptions;\n\n  private classes: string[];\n  private activeClasses: Map<HTMLElement, string[]>;\n  private listeners: Map<HTMLElement, ListenerRef[]>;\n  private timeouts: Map<HTMLElement, TimeoutRef[]>;\n  private styles: Map<HTMLElement, CSSStyleDeclaration>;\n\n  // Public Methods\n\n  constructor() {\n    this.animationOptions = Object.assign(\n      {}, AnimationBuilder.defaults,\n    );\n\n    this.defaultOptions = Object.assign(\n      {}, this.animationOptions,\n    );\n\n    this.classes = [];\n    this.activeClasses = new Map<HTMLElement, string[]>();\n    this.listeners = new Map<HTMLElement, ListenerRef[]>();\n    this.timeouts = new Map<HTMLElement, TimeoutRef[]>();\n    this.styles = new Map<HTMLElement, CSSStyleDeclaration>();\n    this.log('AnimationBuilder created.');\n  }\n\n  public show(element: HTMLElement): Promise<HTMLElement> {\n    return this.animate(element, AnimationMode.Show);\n  }\n\n  public hide(element: HTMLElement): Promise<HTMLElement> {\n    return this.animate(element, AnimationMode.Hide);\n  }\n\n  public stop(element: HTMLElement, reset = true): Promise<HTMLElement> {\n    this.removeTimeouts(element);\n    this.removeListeners(element);\n    if (reset) this.reset(element, false);\n    return Promise.resolve(element);\n  }\n\n  public animate(element: HTMLElement, mode = AnimationMode.Animate): Promise<HTMLElement> {\n    if (AnimationBuilder.disabled || this.animationOptions.disabled) {\n      return this.animateDisabled(element, mode);\n    }\n\n    if (mode === AnimationMode.Show) {\n      this.hideElement(element);\n    }\n\n    return new Promise<HTMLElement>((resolve: Function, reject: Function) => {\n      this.removeTimeouts(element);\n\n      const delay = setTimeout(() => {\n        this.reset(element, true, false, true);\n        this.registerAnimationListeners(element, mode, resolve, reject);\n        this.saveStyle(element);\n        this.saveClasses(element, mode)\n        this.pinElement(element, mode);\n\n        this.nextFrame(() => {\n          this.showElement(element, mode);\n          this.applyProperties(element, mode);\n        });\n      }, this.animationOptions.delay);\n\n      this.addTimeout(element, delay, reject);\n      this.log(`Timeout ${delay} registered for element`, element);\n    });\n  }\n\n  public reset(element: HTMLElement, removePending = true, rejectTimeouts = false, rejectListeners = false): void {\n    if (removePending) {\n      this.removeTimeouts(element, rejectTimeouts);\n      this.removeListeners(element, rejectListeners);\n    }\n\n    this.removeStyles(element);\n    this.removeClasses(element);\n  }\n\n  public dispose(): void {\n    this.timeouts.forEach(refs => {\n      for (let t of refs) {\n        clearTimeout(t.timeout);\n      }\n    });\n\n    this.listeners.forEach((refs, el) => {\n      for (let l of refs) {\n        el.removeEventListener(l.eventName, l.handler);\n      }\n    });\n\n    this.classes = [];\n    this.styles = new Map<HTMLElement, CSSStyleDeclaration>();\n    this.timeouts = new Map<HTMLElement, TimeoutRef[]>();\n    this.listeners = new Map<HTMLElement, ListenerRef[]>();\n  }\n\n  public addAnimationClass(name: string): AnimationBuilder {\n    if (this.classes.indexOf(name) === -1) {\n      this.classes.push(name);\n    }\n\n    return this;\n  }\n\n  public removeAnimationClass(name: string): AnimationBuilder {\n    let index = this.classes.indexOf(name);\n\n    if (index !== -1) {\n      this.classes.splice(index, 1);\n    }\n\n    return this;\n  }\n\n  // Public Static Methods\n\n  public static get DEBUG(): boolean {\n    return AnimationBuilder._DEBUG;\n  }\n\n  public static set DEBUG(debug: boolean) {\n    AnimationBuilder._DEBUG = debug;\n  }\n\n  public static get disabled(): boolean {\n    return AnimationBuilder._disabled;\n  }\n\n  public static set disabled(disabled: boolean) {\n    AnimationBuilder._disabled = disabled;\n  }\n\n  public static get defaults(): AnimationOptions {\n    return AnimationBuilder._defaults;\n  }\n\n  // Private Methods\n\n  public animateDisabled(element: HTMLElement, mode: AnimationMode): Promise<HTMLElement> {\n    if (mode === AnimationMode.Show) {\n      this.showElement(element, mode);\n    } else if(mode === AnimationMode.Hide) {\n      this.hideElement(element, mode);\n    }\n\n    return Promise.resolve(element);\n  }\n\n  private log(...values: any[]): void {\n    if (AnimationBuilder.DEBUG) {\n      console.log('css-animator:', ...values);\n    }\n  }\n\n  private nextFrame(fn: Function): void {\n    AnimationBuilder.raf(() => {\n      AnimationBuilder.raf(fn);\n    });\n  }\n\n  private camelCase(input: string): string {\n    return input.toLowerCase().replace(/-(.)/g, (match, group) => {\n      return group.toUpperCase();\n    });\n  }\n\n  private hideElement(element: HTMLElement, mode?: AnimationMode): void {\n    if (this.animationOptions.useVisibility) {\n      element.style.visibility = 'hidden';\n      return;\n    }\n\n    element.setAttribute('hidden', '');\n  }\n\n  private showElement(element: HTMLElement, mode?: AnimationMode): void {\n    if (this.animationOptions.pin && mode === AnimationMode.Show) {\n      element.style.visibility = 'visible';\n    }\n\n    if (this.animationOptions.useVisibility) {\n      element.style.visibility = 'visible';\n      return;\n    }\n\n    element.removeAttribute('hidden');\n  }\n\n  private pinElement(element: HTMLElement, mode: AnimationMode): void {\n    if (!this.animationOptions.pin) return;\n\n    if (mode === AnimationMode.Show) {\n      element.style.visibility = 'hidden';\n    }\n\n    if (!this.animationOptions.useVisibility) {\n      this.showElement(element);\n    }\n\n    const position = this.getPosition(element);\n\n    element.style.position = this.animationOptions.fixed ? 'fixed' : 'absolute';\n    element.style.top = `${position.top}px`;\n    element.style.left = `${position.left}px`;\n    element.style.width = `${position.width}px`;\n    element.style.height = `${position.height}px`;\n    element.style.margin = '0px';\n  }\n\n  private getPosition(element: HTMLElement): { left: number, top: number, width: number, height: number } {\n    const rect = element.getBoundingClientRect();\n    const cs = window.getComputedStyle(element);\n\n    let left = element.offsetLeft;\n    let top = element.offsetTop;\n\n    let width = rect.width -\n      parseFloat(cs.paddingLeft) - parseFloat(cs.paddingRight) -\n      parseFloat(cs.borderLeftWidth) - parseFloat(cs.borderRightWidth);\n\n    let height = rect.height -\n      parseFloat(cs.paddingTop) - parseFloat(cs.paddingBottom) -\n      parseFloat(cs.borderTopWidth) - parseFloat(cs.borderBottomWidth);\n\n    if (this.animationOptions.fixed) {\n      left = rect.left + window.scrollX;\n      top = rect.top + window.scrollY;\n    }\n\n    return { left, top, width, height };\n  }\n\n  private registerAnimationListeners(element: HTMLElement, mode: AnimationMode, resolve: Function, reject: Function): void {\n    const animationStartEvent = this.animationStartEvent(element);\n    const animationEndEvent = this.animationEndEvent(element);\n\n    let startHandler: () => any;\n    element.addEventListener(animationStartEvent, startHandler = () => {\n      this.log(`Animation start handler fired for element`, element);\n      element.removeEventListener(animationStartEvent, startHandler);\n      return startHandler;\n    });\n\n    this.log(`Registered animation start listener for element`, element);\n\n    let endHandler: () => any;\n    element.addEventListener(animationEndEvent, endHandler = () => {\n      this.log(`Animation end handler fired for element`, element);\n      element.removeEventListener(animationEndEvent, endHandler);\n      this.removeListeners(element, false);\n      this.reset(element, true, false, false);\n      if (mode === AnimationMode.Hide) this.hideElement(element);\n      if (mode === AnimationMode.Show) this.showElement(element);\n      resolve(element);\n      return endHandler;\n    });\n\n    this.log(`Registered animation end listener for element`, element);\n\n    this.addListener(element, animationStartEvent, startHandler);\n    this.addListener(element, animationEndEvent, endHandler, reject);\n  }\n\n  private addTimeout(element: HTMLElement, timeout: number, reject?: Function): void {\n    if (!this.timeouts.has(element)) {\n      this.timeouts.set(element, []);\n    }\n\n    this.timeouts.get(element).push({\n      timeout,\n      reject,\n    });\n  }\n\n  private addListener(element: HTMLElement, eventName: string, handler: () => any, reject?: Function): void {\n    if (!this.listeners.has(element)) {\n      this.listeners.set(element, []);\n    }\n\n    const classes = Object.assign({}, this.classes);\n\n    this.listeners.get(element).push({\n      eventName,\n      handler,\n      reject,\n      classes,\n    });\n  }\n\n  private removeListeners(element: HTMLElement, reject = false): void {\n    if (!this.listeners.has(element)) return;\n\n    this.listeners.get(element)\n      .forEach(ref => {\n        element.removeEventListener(ref.eventName, ref.handler);\n        this.log(`Listener ${ref.eventName} removed for element`, element);\n        if (reject && this.animationOptions.reject && ref.reject) ref.reject('animation_aborted');\n      });\n\n    this.listeners.delete(element);\n  }\n\n  private removeTimeouts(element: HTMLElement, reject = false): void {\n    if (!this.timeouts.has(element)) return;\n\n    this.timeouts.get(element)\n      .forEach(ref => {\n        clearTimeout(ref.timeout);\n        this.log(`Timeout ${ref.timeout} removed for element`, element);\n        if (reject && this.animationOptions.reject && ref.reject) ref.reject('animation_aborted');\n      });\n\n    this.timeouts.delete(element);\n  }\n\n  private animationEndEvent(element: HTMLElement): string {\n    let el = document.createElement('endAnimationElement');\n\n    let animations: { [key: string]: string } = {\n      animation: 'animationend',\n      OAnimation: 'oAnimationEnd',\n      MozAnimation: 'animationend',\n      WebkitAnimation: 'webkitAnimationEnd',\n    };\n\n    for (let animation in animations) {\n      if (el.style[animation] !== undefined) {\n        return animations[animation];\n      }\n    }\n\n    return null;\n  }\n\n  private animationStartEvent(element: HTMLElement): string {\n    let el = document.createElement('startAnimationElement');\n\n    let animations: { [key: string]: string } = {\n      animation: 'animationstart',\n      OAnimation: 'oAnimationStart',\n      MozAnimation: 'animationstart',\n      WebkitAnimation: 'webkitAnimationStart',\n    };\n\n    for (let animation in animations) {\n      if (el.style[animation] !== undefined) {\n        return animations[animation];\n      }\n    }\n\n    return null;\n  }\n\n  private applyProperties(element: HTMLElement, mode?: AnimationMode): void {\n    this.applyClasses(element, mode);\n    this.applyStyles(element, mode);\n  }\n\n  private saveStyle(element: HTMLElement): void {\n    const styles: any = {};\n\n    for (let style in element.style) {\n      styles[style] = element.style.getPropertyValue(style)\n    }\n\n    this.styles.set(element, styles);\n  }\n\n  private applyStyles(element: HTMLElement, mode?: AnimationMode): void {\n    this.applyFillMode(element);\n    this.applyTimingFunction(element);\n    this.applyPlayState(element);\n    this.applyDirection(element);\n    this.applyDuration(element);\n    this.applyIterationCount(element);\n  }\n\n  private removeStyles(element: HTMLElement): void {\n    if (!this.styles.has(element)) return;\n\n    const styles = this.styles.get(element);\n    element.removeAttribute('style');\n\n    for (let style in styles) {\n      element.style.setProperty(style, styles[style]);\n    }\n\n    this.styles.delete(element);\n  }\n\n  private saveClasses(element: HTMLElement, mode: AnimationMode): void {\n    const classes = this.classes.slice(0);\n\n    switch (mode) {\n      case AnimationMode.Show:\n        classes.push('animated-show');\n        break;\n      case AnimationMode.Hide:\n        classes.push('animated-hide');\n        break;\n    }\n\n    classes.push('animated', this.animationOptions.type);\n    this.activeClasses.set(element, classes);\n  }\n\n  private applyClasses(element: HTMLElement, mode?: AnimationMode): void {\n    const active = this.activeClasses.get(element) || [];\n\n    element.classList.add(\n      'animated',\n      ...active,\n    );\n  }\n\n  private removeClasses(element: HTMLElement): void {\n    const active = this.activeClasses.get(element) || [];\n\n    element.classList.remove(\n      'animated',\n      'animated-show',\n      'animated-hide',\n      ...active,\n    );\n\n    this.activeClasses.delete(element);\n  }\n\n  private applyStyle(element: HTMLElement, prop: string, value: string | number | boolean) {\n    let el = document.createElement('checkStyle');\n\n    let styles: { [key: string]: string } = {\n      standard: this.camelCase(prop),\n      webkit: this.camelCase(`-webkit-${prop}`),\n      mozilla: this.camelCase(`-moz-${prop}`),\n      opera: this.camelCase(`-o-${prop}`),\n      explorer: this.camelCase(`-ie-${prop}`),\n    };\n\n    for (let style in styles) {\n      if (!styles.hasOwnProperty(style)) continue;\n      if (el.style[styles[style]] !== undefined) {\n        element.style[styles[style]] = value === undefined || value === null ? null : value;\n        break;\n      }\n    }\n\n    return this;\n  }\n\n  // Getters and Setters\n\n  get defaults(): AnimationOptions {\n    return this.defaultOptions;\n  }\n\n  set defaults(defaults: AnimationOptions) {\n    this.defaultOptions = defaults;\n  }\n\n  public setDefaults(defaults: AnimationOptions): AnimationBuilder {\n    this.defaults = defaults;\n    return this;\n  }\n\n  get options(): AnimationOptions {\n    return this.animationOptions;\n  }\n\n  set options(options: AnimationOptions) {\n    this.animationOptions = options;\n  }\n\n  public setOptions(options: AnimationOptions): AnimationBuilder {\n    Object.assign(this.options, options);\n    return this;\n  }\n\n  get disabled(): boolean {\n    return this.animationOptions.disabled;\n  }\n\n  set disabled(disabled: boolean) {\n    this.animationOptions.disabled = disabled;\n  }\n\n  get reject(): boolean {\n    return this.animationOptions.reject;\n  }\n\n  set reject(reject: boolean) {\n    this.animationOptions.reject = reject;\n  }\n\n  get pin(): boolean {\n    return this.animationOptions.pin;\n  }\n\n  set pin(pin: boolean) {\n    this.animationOptions.pin = pin;\n  }\n\n  public setPin(pin: boolean): AnimationBuilder {\n    this.pin = pin;\n    return this;\n  }\n\n  get useVisibility(): boolean {\n    return this.animationOptions.useVisibility;\n  }\n\n  set useVisibility(useVisibility: boolean) {\n    this.animationOptions.useVisibility = useVisibility;\n  }\n\n  public setUseVisibility(useVisibility: boolean): AnimationBuilder {\n    this.useVisibility = useVisibility;\n    return this;\n  }\n\n  get type(): string {\n    return this.animationOptions.type;\n  }\n\n  set type(type: string) {\n    this.animationOptions.type = type;\n  }\n\n  public setType(type: string): AnimationBuilder {\n    this.type = type;\n    return this;\n  }\n\n  get fillMode(): string {\n    return this.animationOptions.fillMode;\n  }\n\n  set fillMode(fillMode: string) {\n    this.animationOptions.fillMode = fillMode;\n  }\n\n  public setFillMode(fillMode: string): AnimationBuilder {\n    this.fillMode = fillMode;\n    return this;\n  }\n\n  public applyFillMode(element: HTMLElement, fillMode?: string): AnimationBuilder {\n    this.applyStyle(\n      element,\n      'animation-fill-mode',\n      fillMode || this.animationOptions.fillMode,\n    );\n\n    return this;\n  }\n\n  get timingFunction(): string {\n    return this.animationOptions.timingFunction;\n  }\n\n  set timingFunction(timingFunction: string) {\n    this.animationOptions.timingFunction = timingFunction;\n  }\n\n  public setTimingFunction(timingFunction: string): AnimationBuilder {\n    this.timingFunction = timingFunction;\n    return this;\n  }\n\n  public applyTimingFunction(element: HTMLElement, timingFunction?: string): AnimationBuilder {\n    this.applyStyle(\n      element,\n      'animation-timing-function',\n      timingFunction || this.animationOptions.timingFunction\n    );\n\n    return this;\n  }\n\n  get playState(): string {\n    return this.animationOptions.playState;\n  }\n\n  set playState(playState: string) {\n    this.animationOptions.playState = playState;\n  }\n\n  public setPlayState(playState: string): AnimationBuilder {\n    this.playState = playState;\n    return this;\n  }\n\n  public applyPlayState(element: HTMLElement, playState?: string): AnimationBuilder {\n    this.applyStyle(\n      element,\n      'animation-play-state',\n      playState || this.animationOptions.playState,\n    );\n\n    return this;\n  }\n\n  get direction(): string {\n    return this.animationOptions.direction;\n  }\n\n  set direction(direction: string) {\n    this.animationOptions.direction = direction;\n  }\n\n  public setDirection(direction: string): AnimationBuilder {\n    this.direction = direction;\n    return this;\n  }\n\n  public applyDirection(element: HTMLElement, direction?: string): AnimationBuilder {\n    this.applyStyle(\n      element,\n      'animation-direction',\n      direction || this.animationOptions.direction,\n    );\n\n    return this;\n  }\n\n  get duration(): number {\n    return this.animationOptions.duration;\n  }\n\n  set duration(duration: number) {\n    this.animationOptions.duration = duration;\n  }\n\n  public setDuration(duration: number): AnimationBuilder {\n    this.duration = duration;\n    return this;\n  }\n\n  public applyDuration(element: HTMLElement, duration?: number): AnimationBuilder {\n    this.applyStyle(\n      element,\n      'animation-duration',\n      `${duration || this.animationOptions.duration}ms`,\n    );\n\n    return this;\n  }\n\n  get delay(): number {\n    return this.animationOptions.delay;\n  }\n\n  set delay(delay: number) {\n    this.animationOptions.delay = delay;\n  }\n\n  public setDelay(delay: number): AnimationBuilder {\n    this.delay = delay;\n    return this;\n  }\n\n  public applyDelayAsStyle(element: HTMLElement, delay?: number): AnimationBuilder {\n    this.applyStyle(\n      element,\n      'animation-delay',\n      `${delay || this.animationOptions.delay}ms`,\n    );\n\n    return this;\n  }\n\n  get iterationCount(): number | string {\n    return this.animationOptions.iterationCount;\n  }\n\n  set iterationCount(iterationCount: number | string) {\n    this.animationOptions.iterationCount = iterationCount;\n  }\n\n  public setIterationCount(iterationCount: number | string): AnimationBuilder {\n    this.iterationCount = iterationCount;\n    return this;\n  }\n\n  public applyIterationCount(element: HTMLElement, iterationCount?: number | string): AnimationBuilder {\n    this.applyStyle(\n      element,\n      'animation-iteration-count',\n      iterationCount || this.animationOptions.iterationCount,\n    );\n\n    return this;\n  }\n\n}\n"]}